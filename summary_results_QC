
% QCanalysis

% % all parameters
% T = table(IC.ID,IC.specimen,IC.struct,IC.cortical_layer,IC.transline,IC.reporterStatus,...
%     IC.dendrite_type,pyramidalID,IC.temperature,IC.resistance,IC.access_resistance,...
%     IC.time_constant,time_constant2,IC.subamp,submin,rebound_slope,nb_rebound_sp,IC.sag,...
%     IC.steadystate,IC.sag_ratio,IC.rheobaseLP,IC.delay,IC.burst,IC.latency,IC.cv_ISI,adaptation1,...
%     adaptation2,peak_adaptation1,peak_adaptation2,IC.peakLP,IC.thresholdLP,...
%     IC.half_width_threshold_peak,IC.half_width_peak_trough,...
%     IC.height_threshold_peak,IC.height_peak_trough,...
%     IC.peak_up_stroke,IC.peak_down_stroke,IC.peak_stroke_ratio,IC.trough,...
%     IC.fastTrough,IC.slowTrough,IC.maxFiringRate);
%     writetable(T,[savefilename,'.xlsx'],'Sheet','Sheet1',...
%         'WriteRowNames',true)
% % sweeps that pass qc
% T = table(IC.ID,qc_class_mat);
%     writetable(T,[savefilename,'.xlsx'],'Sheet','Sheet2',...
%         'WriteRowNames',true)
% % spike trains all sweeps
% T = table(IC.ID,IC.input_current_s,IC.firing_rate_s,train_delay,train_burst,...
%     train_latency,train_cv_ISI,train_adaptation1,train_adaptation2,...
%     train_peak_adaptation1,train_peak_adaptation2);
%     writetable(T,[savefilename,'.xlsx'],'Sheet','Sheet3',...
%         'WriteRowNames',true)
% % qc parameters for all sweeps
% T = table(IC.ID,meanOrigV,diffMinMaxV,stdOrigV,qc_V_vec,qc_restVpre,qc_restVpost,qc_restVdiffpreNpost,...
%     qc_rmse_pre_lt,qc_rmse_post_lt,qc_rmse_pre_st,qc_rmse_post_st);
%     writetable(T,[savefilename,'.xlsx'],'Sheet','Sheet4',...
%         'WriteRowNames',true)
% % waveforms
% T = table(IC.ID,wf);
%     writetable(T,[savefilename,'.xlsx'],'Sheet','Sheet5',...
%         'WriteRowNames',true)
% % close excel
% system('taskkill /F /IM EXCEL.EXE');
